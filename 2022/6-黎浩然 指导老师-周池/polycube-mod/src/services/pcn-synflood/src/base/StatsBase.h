/**
* synflood API generated from synflood.yang
*
* NOTE: This file is auto generated by polycube-codegen
* https://github.com/polycube-network/polycube-codegen
*/


/* Do not edit this file manually */

/*
* StatsBase.h
*
*
*/

#pragma once

#include "../serializer/StatsJsonObject.h"






#include <spdlog/spdlog.h>

using namespace polycube::service::model;

class Synflood;

class StatsBase {
 public:

  StatsBase(Synflood &parent);

  virtual ~StatsBase();
  virtual void update(const StatsJsonObject &conf);
  virtual StatsJsonObject toJsonObject();

  /// <summary>
  /// Number of failed TCP connections
  /// </summary>
  virtual std::string getTcpattemptfails() = 0;

  /// <summary>
  /// Number of TCP segments sent, containing the RST flag
  /// </summary>
  virtual std::string getTcpoutrsts() = 0;

  /// <summary>
  /// Ratio between the number of IP pkts delivered to application protocols and the total number of received pkts
  /// </summary>
  virtual std::string getDeliverratio() = 0;

  /// <summary>
  /// Ratio between the number of IP pkts requests to send by application protocols and the total number of received pkts
  /// </summary>
  virtual std::string getResponseratio() = 0;

  /// <summary>
  /// last update (time from epoch in milliseconds)
  /// </summary>
  virtual uint64_t getLastupdate() = 0;

  std::shared_ptr<spdlog::logger> logger();
 protected:
  Synflood &parent_;
};
